# Enhancing disease detection in radiology reports through fine-tuning lightweight LLM on weak labels
This is the code for our work that finetunes a lightweight model (Llama3.1-8B-instruct) from on synthetic labels. There are two sources of label: labels generated by GPT and labels generated by a rule based system (Negbio). 
Arxiv: https://arxiv.org/abs/2409.16563

## Data
entity_9000_mimic_4500.json: data for fine tuning the model
mimic_radiologist_label_100.csv: selected mimic reports with human annotated labels

## GPT data annotation
gpt_data_generate.py 
input is csv file containing the notes of interest

## Fine tune model
The fine tune is based on torchtune framework https://github.com/pytorch/torchtune. Revise the related fields in 8B_lora_single_device.yaml

tune run lora_finetune_single_device --config ./8B_lora_single_device.yaml

## Inference/Usage
inference.py provides sample usage for inference. It is based on MIMIC dataset